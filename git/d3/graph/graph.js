
var links = 
[
    {
      "source": "Harry",
      "target": "Sally",
      "value": "1"
    },
    {
      "source": "Harry",
      "target": "Mario",
      "value": "5"
    },
    {
      "source": "Sarah",
      "target": "Alice",
      "value": "5"
    },
    {
      "source": "Eveie",
      "target": "Alice",
      "value": "1"
    },
    {
      "source": "Peter",
      "target": "Alice",
      "value": "1"
    },
    {
      "source": "Mario",
      "target": "Alice",
      "value": "2"
    },
    {
      "source": "James",
      "target": "Alice",
      "value": "3"
    },
    {
      "source": "Alice",
      "target": "James",
      "value": "1"
    },
    {
      "source": "Harry",
      "target": "Carol",
      "value": "5"
    },
    {
      "source": "Harry",
      "target": "Nicky",
      "value": "2"
    },
    {
      "source": "Bobby",
      "target": "Frank",
      "value": "5"
    },
    {
      "source": "Alice",
      "target": "Mario",
      "value": "6"
    },
    {
      "source": "Harry",
      "target": "Lynne",
      "value": "5"
    },
    {
      "source": "Sarah",
      "target": "James",
      "value": "4"
    },
    {
      "source": "Roger",
      "target": "James",
      "value": "3"
    },
    {
      "source": "Maddy",
      "target": "James",
      "value": "4"
    },
    {
      "source": "Sonny",
      "target": "Roger",
      "value": "1"
    },
    {
      "source": "Roger",
      "target": "Sonny",
      "value": "4"
    },
    {
      "source": "James",
      "target": "Roger",
      "value": "3"
    },
    {
      "source": "Alice",
      "target": "Peter",
      "value": "2"
    },
    {
      "source": "Johan",
      "target": "Peter",
      "value": "5"
    },
    {
      "source": "Alice",
      "target": "Eveie",
      "value": "3"
    },
    {
      "source": "Harry",
      "target": "Eveie",
      "value": "1"
    },
    {
      "source": "Eveie",
      "target": "Harry",
      "value": "3"
    },
    {
      "source": "Henry",
      "target": "Mikey",
      "value": "6"
    },
    {
      "source": "Elric",
      "target": "Mikey",
      "value": "2"
    },
    {
      "source": "James",
      "target": "Sarah",
      "value": "2"
    },
    {
      "source": "Alice",
      "target": "Sarah",
      "value": "2"
    },
    {
      "source": "James",
      "target": "Maddy",
      "value": "2"
    },
    {
      "source": "Peter",
      "target": "Johan",
      "value": "3"
    },
    {
      "source": "Sonny",
      "target": "Johan",
      "value": "5"
    },
    {
      "source": "Johan",
      "target": "Sonny",
      "value": "4"
    },
    {
      "source": "PoloClub",
      "target": "Robert",
      "value": "2"
    },
    {
      "source": "PoloClub",
      "target": "Brian",
      "value": "4"
    },
    {
      "source": "PoloClub",
      "target": "Shang",
      "value": "1"
    },
    {
      "source": "PoloClub",
      "target": "Akanksha",
      "value": "1"
    },
    {
      "source": "PoloClub",
      "target": "Andy",
      "value": "1"
    },
    {
      "source": "PoloClub",
      "target": "Sam",
      "value": "3"
    },
    {
      "source": "PoloClub",
      "target": "Paras",
      "value": "5"
    },
    {
      "source": "PoloClub",
      "target": "Nathan",
      "value": "2"
    },
    {
      "source": "PoloClub",
      "target": "Polo",
      "value": "6"
    },
    {
      "source": "PoloClub",
      "target": "Vishal",
      "value": "2"
    },
    {
      "source": "Polo",
      "target": "Vivek",
      "value": "2"
    },
    {
      "source": "Polo",
      "target": "Vishal",
      "value": "2"
    },
    {
      "source": "Polo",
      "target": "Yuyu",
      "value": "1"
    },
    {
      "source": "Polo",
      "target": "Chirag",
      "value": "1"
    },
    {
      "source": "Polo",
      "target": "Kiran",
      "value": "6"
    },
    {
      "source": "Polo",
      "target": "Varun",
      "value": "2"
    },
    {
      "source": "Vivek",
      "target": "Vishal",
      "value": "5"
    },
    {
      "source": "Vivek",
      "target": "Yuyu",
      "value": "1"
    },
    {
      "source": "Vivek",
      "target": "Kiran",
      "value": "2"
    },
    {
      "source": "Vivek",
      "target": "Varun",
      "value": "2"
    },
    {
      "source": "Yuyu",
      "target": "Vishal",
      "value": "1"
    },
    {
      "source": "Yuyu",
      "target": "Chirag",
      "value": "2"
    },
    {
      "source": "Yuyu",
      "target": "Kiran",
      "value": "3"
    },
    {
      "source": "Chirag",
      "target": "Vivek",
      "value": "1"
    },
    {
      "source": "Chirag",
      "target": "Vishal",
      "value": "6"
    },
    {
      "source": "Chirag",
      "target": "Kiran",
      "value": "6"
    },
    {
      "source": "Chirag",
      "target": "Vivek",
      "value": "6"
    },
    {
      "source": "Kiran",
      "target": "Vishal",
      "value": "4"
    },
    {
      "source": "Kiran",
      "target": "Varun",
      "value": "6"
    },
    {
      "source": "Varun",
      "target": "Vishal",
      "value": "5"
    },
    {
      "source": "Varun",
      "target": "Yuyu",
      "value": "3"
    },
    {
      "source": "Varun",
      "target": "Chirag",
      "value": "2"
    },
    {
      "source": "Maddy",
      "target": "Rita",
      "value": "5"
    },
    {
      "source": "Rita",
      "target": "Steve",
      "value": "3"
    },
    {
      "source": "Steve",
      "target": "Rita",
      "value": "3"
    },
    {
      "source": "Steve",
      "target": "Sean",
      "value": "2"
    },
    {
      "source": "Sean",
      "target": "Preston",
      "value": "2"
    },
    {
      "source": "Preston",
      "target": "Sean",
      "value": "2"
    },
    {
      "source": "Sean",
      "target": "Rita",
      "value": "2"
    }
  ];
var node = {};

var width = 960,
    height = 500;
console.log(node);
// Set the range
var  linkscale = d3.scale.linear().range([0, 100]);

// append svg to the body
    var svg = d3.select("#svg").append("svg")
    .attr("width", 960)
    .attr("height", 600);

// d3.json("graph.json", function(links){

    // Scale the range of the data
    linkscale.domain([0, d3.max(links, function(d) { return d.value; })]);
    // Compute the distinct nodes from the links.
    links.forEach(function(data){
        data.source = node[data.source] || (node[data.source] = {name: data.source});
        data.target = node[data.target] || (node[data.target] = {name: data.target});
    });    

    var force = d3.layout.force()
    .nodes(d3.values(node))
    .links(links)
    .size([width, height])
    .linkDistance(60)
    .charge(-250)
    .start();

    // add the links and the arrows
    var path = svg.append("svg:g").selectAll("path")
        .data(force.links())
        .enter().append("path")
        .attr("class", function(d) { return "curve " + d.type; });

    // define the nodes
    var nodes = svg.selectAll(".node")
        .data(force.nodes())
        .enter().append("g")
        .attr("class", "node")        
        .on("dblclick", dblclick)
        .call(force.drag());

    // add the nodes
    nodes.append("circle")
        .attr("r", function(d){
            return d.weight + 2;
        });

    // add the node labels
    nodes.append("text")
        .attr("dx", 12)
        .attr("dy", ".5em")
        .text(function(d){return d.name});    
        
    // add curve lines    
    force.on("tick", function(d){

        path.attr("d", function(d) {
            var dx = d.target.x - d.source.x,
                dy = d.target.y - d.source.y,
                dr = Math.sqrt(dx * dx + dy * dy);
            return "M" +
                d.source.x + "," +
                d.source.y + "A" +
                dr + "," + dr + " 0 0,1 " +
                d.target.x + "," +
                d.target.y;
        })
        .attr("stroke", function(d){ // color the link based on the value.
            if(parseInt(d.value) > 4){
                return "blue";
            }else if(parseInt(d.value) <= 4 && parseInt(d.value) >= 3){
                return "red";
            }else if(parseInt(d.value) < 3) {
                return "green";
            }
        });

        nodes.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")"; });
    });    
// });

// use flag to do dblclick function of pinnig node.
var flag = false;    

function dblclick(d) {

    if(flag == false){
        flag = true;
        d3.select(this).classed("fixed", d.fixed = false);      
    } else {
        flag = false;
        d3.select(this).classed("fixed", d.fixed = true);
    }
}

